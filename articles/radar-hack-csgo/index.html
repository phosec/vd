<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>CS:GO Radar Hack en moins de 40 lignes de code | Violence Digital</title>
<meta name=keywords content="csgo,gamehacking,reverse">
<meta name=description content="Qu&rsquo;est-ce qu&rsquo;un RadarHack dans CSGO ? Le radar affiche les cibles visibles à l&rsquo;aide de points rouges. Techniquement, le client du jeu passe un attribut de type boolean à TRUE que l&rsquo;on appelera &ldquo;spotted&rdquo; dans cet article. Le but est de forcer ce mécanisme afin de gagner un avantage sur les autres joueurs. En trouvant la structure en mémoire qui corresponds aux joueurs, nous pourrons changer la valeur de ce boolean à TRUE en écrivant dans la mémoire du client.">
<meta name=author content="phos">
<link rel=canonical href=https://canonical.url/to/page>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.565d5741ff348f45c86cd9dd9df8d391964a5b6397766431b849e75ad7a4041b.css integrity="sha256-Vl1XQf80j0XIbNndnfjTkZZKW2OXdmQxuEnnWtekBBs=" rel="preload stylesheet" as=style>
<link rel=preload href=/logo.png as=image>
<link rel=icon href=https://violence.digital/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://violence.digital/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=https://violence.digital/favicon.ico>
<link rel=apple-touch-icon href=https://violence.digital/appletouch.ico>
<link rel=mask-icon href=https://violence.digital/safari.ico>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.87.0">
<meta property="og:title" content="CS:GO Radar Hack en moins de 40 lignes de code">
<meta property="og:description" content="Qu&rsquo;est-ce qu&rsquo;un RadarHack dans CSGO ? Le radar affiche les cibles visibles à l&rsquo;aide de points rouges. Techniquement, le client du jeu passe un attribut de type boolean à TRUE que l&rsquo;on appelera &ldquo;spotted&rdquo; dans cet article. Le but est de forcer ce mécanisme afin de gagner un avantage sur les autres joueurs. En trouvant la structure en mémoire qui corresponds aux joueurs, nous pourrons changer la valeur de ce boolean à TRUE en écrivant dans la mémoire du client.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://violence.digital/articles/radar-hack-csgo/"><meta property="article:section" content="articles">
<meta property="article:published_time" content="2021-08-14T00:00:00+00:00">
<meta property="article:modified_time" content="2021-08-14T00:00:00+00:00"><meta property="og:site_name" content="Violence Digital">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="CS:GO Radar Hack en moins de 40 lignes de code">
<meta name=twitter:description content="Qu&rsquo;est-ce qu&rsquo;un RadarHack dans CSGO ? Le radar affiche les cibles visibles à l&rsquo;aide de points rouges. Techniquement, le client du jeu passe un attribut de type boolean à TRUE que l&rsquo;on appelera &ldquo;spotted&rdquo; dans cet article. Le but est de forcer ce mécanisme afin de gagner un avantage sur les autres joueurs. En trouvant la structure en mémoire qui corresponds aux joueurs, nous pourrons changer la valeur de ce boolean à TRUE en écrivant dans la mémoire du client.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Articles","item":"https://violence.digital/articles/"},{"@type":"ListItem","position":2,"name":"CS:GO Radar Hack en moins de 40 lignes de code","item":"https://violence.digital/articles/radar-hack-csgo/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CS:GO Radar Hack en moins de 40 lignes de code","name":"CS:GO Radar Hack en moins de 40 lignes de code","description":"Qu\u0026rsquo;est-ce qu\u0026rsquo;un RadarHack dans CSGO ? Le radar affiche les cibles visibles à l\u0026rsquo;aide de points rouges. Techniquement, le client du jeu passe un attribut de type boolean à TRUE que l\u0026rsquo;on appelera \u0026ldquo;spotted\u0026rdquo; dans cet article. Le but est de forcer ce mécanisme afin de gagner un avantage sur les autres joueurs. En trouvant la structure en mémoire qui corresponds aux joueurs, nous pourrons changer la valeur de ce boolean à TRUE en écrivant dans la mémoire du client.","keywords":["csgo","gamehacking","reverse"],"articleBody":"Qu’est-ce qu’un RadarHack dans CSGO ? Le radar affiche les cibles visibles à l’aide de points rouges. Techniquement, le client du jeu passe un attribut de type boolean à TRUE que l’on appelera “spotted” dans cet article. Le but est de forcer ce mécanisme afin de gagner un avantage sur les autres joueurs. En trouvant la structure en mémoire qui corresponds aux joueurs, nous pourrons changer la valeur de ce boolean à TRUE en écrivant dans la mémoire du client.\nPré-requis Les outils utilisés dans cet article sont :\n Cheat Engine Reclass.net Visual Studio Community avec les additions C++, MSVC 142 et Windows 10 SDK Counter-Strike Global Offensive (gratuit sur Steam)  1ère étape - Récuperer la liste des joueurs Trouver en mémoire le boolean “spotted” Lancer CSGO avec le paramètre --insecure et demarrer une partie local avec des bots. Pour simplifier le process, activez la console dans les options du jeu et éxécuter cette commande une fois en jeu:\n1  mp_roundtime 9999;mp_startmoney 16000;mp_roundtime_defuse 600000;sv_cheats 1;bot_stop 1;mp_restartgame 1;mp_limitteams 30;mp_autoteambalance 0;mp_buytime 99999   Une fois la partie démarrée, lancez Cheat Engine et attacher l’outil à csgo.exe :\nPositionnez vous dans le jeu de manière à pouvoir faire varier la valeur “spotted” facilement puis identifier leurs adresses mémoires avec CE :\n  Dans mon cas, j’ai pu identifier deux adresses mémoires qui correspondent aux valeurs “spotted” de 2 joueurs différents:\nEn changeant leurs valeurs à 1, les points rouges doivent s’afficher sur le radar. Ces adresses étant dynamiques, elles seront différentes à chaque lancement du jeu.\nAnalyse de la structure du joueur en mémoire Afin que notre hack fonctionne après chaque redémarrage du jeu, nous devons trouver un pointeur static qui pointe vers la structure du joueur.\nPour cela, faites un clique droit sur l’une des deux adresses mémoires et cliquer sur “Find out what accesses this address” :\nVoici la ligne éxacte qui accède à notre variable :\n1  test [esi+edx*4+0x980], eax   Ici EDX=0, on peut simplifier l’instruction à ESI+0x980, ESI contient l’adresse vers la structure du joueur et 0x980 est l’offset du boolean “spotted”.\nOn à donc :\n1 2 3  Adresse dynamique de la structure du joueur: 0x68917730 Offset de spotted: 0x980 Adresse dynamique de spotted = 0x68917730+0x980=0x689180B0   Pour trouver son pointeur static, nous pouvons chercher avec CE quelle adresse mémoire pointe vers l’adresse dynamique de la structure (68917730) :\nCheat Engine représente les pointeurs statics en vert, ici : +4DA31EC, 0x4DA31EC est l’offset d’un joueur.\nAvec l’outil Reclass.net, nous allons vérifier si cette adresse correspond bien à la liste des joueurs et si l’offset que nous avons trouvé corresponds au 1er joueur de cette liste.\nFermer Cheat Engine, puis ouvrir Reclass et attacher son debugger à csgo.exe.\nUne fois fait, double cliquer sur l’adresse initiale à la première ligne et écrire le module puis l’offset du joueur, dans notre cas +4DA31EC :\nNous sommes bien dans une liste de joueur. La première ligne corresponds a un pointeur vers la HEAP (la structure d’un joueur), puis d’autre pointeur vers la HEAP qui correspondent aux autres joueurs.\nL’écart en mémoire entre chaqu’un de ces pointeurs est de 0x10, cette information nous servira à itérer sur les joueurs.\nPour trouver le début de cette liste, nous pouvons changer l’adresse de départ dans Reclass à +4DA3100 puis faire clique droit sur la première ligne et Add 2048 Bytes :\nEn scrollant vers le bas, on retombe sur la liste de joueur, ce qui nous permet de récupérer l’offset du premier joueur de la liste :\nL’offset est +4DA31BC, pour résumer, nous avons ces informations :\n1 2 3  Offset de spotted: 0x980 Offset du pointeur correspondant au 1er joueur de la liste: +4DA31BC Écart entre chaque joueur dans la liste 0x10   2ème étape - Création de la DLL Créer un nouveau projet DLL en C++:\nPremièrement, on créé un nouveau Thread lors de l’injection de notre DLL :\n1 2 3 4 5 6  case DLL_PROCESS_ATTACH: { HANDLE hThread = nullptr; hThread = CreateThread(nullptr, 0, (LPTHREAD_START_ROUTINE)RadarHackThread, hModule, 0, nullptr); if (hThread) CloseHandle(hThread); }   Puis on déclare notre Thread comme ceci:\n1 2 3 4 5 6 7 8  DWORD WINAPI RadarHackThread(HMODULE hModule) { while (true) { if (GetAsyncKeyState(VK_END) \u0026 1) break; // La touche END désactive le hack proprement  } FreeLibraryAndExitThread(hModule, 0); Sleep(100); return 0; }   On déclare la liste de joueurs grace à l’offset précédemment trouvé :\n1 2 3 4 5 6 7 8 9 10 11  DWORD WINAPI RadarHackThread(HMODULE hModule) { uintptr_t client = (uintptr_t)GetModuleHandle(L\"client.dll\"); uintptr_t playerList = (client + 0x4DA31BC);  while (true) { if (GetAsyncKeyState(VK_END) \u0026 1) break; } FreeLibraryAndExitThread(hModule, 0); Sleep(100); return 0; }   On itère sur les joueurs en incrémentant l’adresse de 0x10 puis on met spotted a TRUE :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  DWORD WINAPI RadarHackThread(HMODULE hModule) { uintptr_t client = (uintptr_t)GetModuleHandle(L\"client.dll\"); uintptr_t playerList = (client + 0x4DA31BC); while (true) { if (GetAsyncKeyState(VK_END) \u0026 1) break; for (int i = 0; i  32; i++) { uintptr_t player = *(uintptr_t* )(playerList + 0x10 * i); if (player) { int* spotted = (int*)(player + 0x980); *spotted = TRUE; } }  } FreeLibraryAndExitThread(hModule, 0); Sleep(100); return 0; }   En injectant ce DLL dans csgo.exe, le RadarHack devrait etre fonctionnel :\n  Pour créer votre propre injecteur : Injection de DLL - LoadLibrary\n","wordCount":"885","inLanguage":"en","datePublished":"2021-08-14T00:00:00Z","dateModified":"2021-08-14T00:00:00Z","author":{"@type":"Person","name":"phos"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://violence.digital/articles/radar-hack-csgo/"},"publisher":{"@type":"Organization","name":"Violence Digital","logo":{"@type":"ImageObject","url":"https://violence.digital/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://violence.digital/ accesskey=h title="Violence Digital (Alt + H)">
<img src=/logo.png alt=logo aria-label=logo height=45>Violence Digital</a>
<span class=logo-switches>
</span>
</div>
<ul id=menu>
<li>
<a href=https://violence.digital/articles/ title=articles>
<span>articles</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://violence.digital/>Home</a>&nbsp;»&nbsp;<a href=https://violence.digital/articles/>Articles</a></div>
<h1 class=post-title>
CS:GO Radar Hack en moins de 40 lignes de code
</h1>
<div class=post-meta>August 14, 2021&nbsp;·&nbsp;5 min&nbsp;·&nbsp;phos
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<div class=details>Table of Contents</div>
</summary>
<div class=inner><ul>
<li>
<a href=#quest-ce-quun-radarhack-dans-csgo- aria-label="Qu&amp;rsquo;est-ce qu&amp;rsquo;un RadarHack dans CSGO ?">Qu&rsquo;est-ce qu&rsquo;un RadarHack dans CSGO ?</a></li>
<li>
<a href=#pr%c3%a9-requis aria-label=Pré-requis>Pré-requis</a></li>
<li>
<a href=#1%c3%a8re-%c3%a9tape---r%c3%a9cuperer-la-liste-des-joueurs aria-label="1ère étape - Récuperer la liste des joueurs">1ère étape - Récuperer la liste des joueurs</a><ul>
<li>
<a href=#trouver-en-m%c3%a9moire-le-boolean-spotted aria-label="Trouver en mémoire le boolean &amp;ldquo;spotted&amp;rdquo;">Trouver en mémoire le boolean &ldquo;spotted&rdquo;</a></li>
<li>
<a href=#analyse-de-la-structure-du-joueur-en-m%c3%a9moire aria-label="Analyse de la structure du joueur en mémoire">Analyse de la structure du joueur en mémoire</a></li></ul>
</li>
<li>
<a href=#2%c3%a8me-%c3%a9tape---cr%c3%a9ation-de-la-dll aria-label="2ème étape - Création de la DLL">2ème étape - Création de la DLL</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h2 id=quest-ce-quun-radarhack-dans-csgo->Qu&rsquo;est-ce qu&rsquo;un RadarHack dans CSGO ?<a hidden class=anchor aria-hidden=true href=#quest-ce-quun-radarhack-dans-csgo->#</a></h2>
<p>Le radar affiche les cibles visibles à l&rsquo;aide de points rouges. Techniquement, le client du jeu passe un attribut de type boolean à TRUE que l&rsquo;on appelera &ldquo;spotted&rdquo; dans cet article.
<img loading=lazy src=2021-08-15-13-15-03.png#center alt>
</p>
<p>Le but est de forcer ce mécanisme afin de gagner un avantage sur les autres joueurs. En trouvant la structure en mémoire qui corresponds aux joueurs, nous pourrons changer la valeur de ce boolean à TRUE en écrivant dans la mémoire du client.</p>
<p><img loading=lazy src=2021-08-15-13-23-19.png#center alt>
</p>
<h2 id=pré-requis>Pré-requis<a hidden class=anchor aria-hidden=true href=#pré-requis>#</a></h2>
<p>Les outils utilisés dans cet article sont :</p>
<ul>
<li><a href=https://www.cheatengine.org/>Cheat Engine</a></li>
<li><a href=https://github.com/ReClassNET/ReClass.NET/releases/>Reclass.net</a></li>
<li>Visual Studio Community avec les additions C++, MSVC 142 et Windows 10 SDK</li>
<li>Counter-Strike Global Offensive (gratuit sur Steam)</li>
</ul>
<h2 id=1ère-étape---récuperer-la-liste-des-joueurs>1ère étape - Récuperer la liste des joueurs<a hidden class=anchor aria-hidden=true href=#1ère-étape---récuperer-la-liste-des-joueurs>#</a></h2>
<h3 id=trouver-en-mémoire-le-boolean-spotted>Trouver en mémoire le boolean &ldquo;spotted&rdquo;<a hidden class=anchor aria-hidden=true href=#trouver-en-mémoire-le-boolean-spotted>#</a></h3>
<p>Lancer CSGO avec le paramètre <code>--insecure</code> et demarrer une partie local avec des bots. Pour simplifier le process, activez la console dans les options du jeu et éxécuter cette commande une fois en jeu:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>mp_roundtime 9999;mp_startmoney 16000;mp_roundtime_defuse 600000;sv_cheats 1;bot_stop 1;mp_restartgame 1;mp_limitteams 30;mp_autoteambalance 0;mp_buytime 99999
</code></pre></td></tr></table>
</div>
</div><p>Une fois la partie démarrée, lancez Cheat Engine et attacher l&rsquo;outil à csgo.exe :</p>
<p><img loading=lazy src=2021-08-15-16-36-47.png#center alt>
</p>
<p>Positionnez vous dans le jeu de manière à pouvoir faire varier la valeur &ldquo;spotted&rdquo; facilement puis identifier leurs adresses mémoires avec CE :</p>
<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden>
<iframe src=https://player.vimeo.com/video/587580154 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="vimeo video" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</div>
<p>Dans mon cas, j&rsquo;ai pu identifier deux adresses mémoires qui correspondent aux valeurs &ldquo;spotted&rdquo; de 2 joueurs différents:</p>
<p><img loading=lazy src=2021-08-15-17-56-20.png#center alt>
</p>
<p>En changeant leurs valeurs à 1, les points rouges doivent s&rsquo;afficher sur le radar. Ces adresses étant dynamiques, elles seront différentes à chaque lancement du jeu.</p>
<h3 id=analyse-de-la-structure-du-joueur-en-mémoire>Analyse de la structure du joueur en mémoire<a hidden class=anchor aria-hidden=true href=#analyse-de-la-structure-du-joueur-en-mémoire>#</a></h3>
<p>Afin que notre hack fonctionne après chaque redémarrage du jeu, nous devons trouver un pointeur static qui pointe vers la structure du joueur.</p>
<p>Pour cela, faites un clique droit sur l&rsquo;une des deux adresses mémoires et cliquer sur &ldquo;Find out what accesses this address&rdquo; :</p>
<p><img loading=lazy src=2021-08-15-17-58-53.png#center alt>
</p>
<p><img loading=lazy src=2021-08-15-17-59-40.png#center alt>
</p>
<p>Voici la ligne éxacte qui accède à notre variable :</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=nf>test</span> <span class=p>[</span><span class=no>esi</span><span class=err>+</span><span class=no>edx</span><span class=p>*</span><span class=mi>4</span><span class=err>+</span><span class=mi>0x980</span><span class=p>],</span> <span class=no>eax</span>
</code></pre></td></tr></table>
</div>
</div><p>Ici EDX=0, on peut simplifier l&rsquo;instruction à ESI+0x980, ESI contient l&rsquo;adresse vers la structure du joueur et 0x980 est l&rsquo;offset du boolean &ldquo;spotted&rdquo;.</p>
<p>On à donc :</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>Adresse dynamique de la structure du joueur: 0x68917730
Offset de spotted: 0x980
Adresse dynamique de spotted = 0x68917730+0x980=0x689180B0
</code></pre></td></tr></table>
</div>
</div><p>Pour trouver son pointeur static, nous pouvons chercher avec CE quelle adresse mémoire pointe vers l&rsquo;adresse dynamique de la structure (68917730) :</p>
<p><img loading=lazy src=2021-08-15-18-06-51.png#center alt>
</p>
<p>Cheat Engine représente les pointeurs statics en vert, ici : <code>&lt;client.dll>+4DA31EC</code>, <code>0x4DA31EC</code> est l&rsquo;offset d&rsquo;un joueur.</p>
<p>Avec l&rsquo;outil Reclass.net, nous allons vérifier si cette adresse correspond bien à la liste des joueurs et si l&rsquo;offset que nous avons trouvé corresponds au 1er joueur de cette liste.</p>
<p>Fermer Cheat Engine, puis ouvrir Reclass et attacher son debugger à csgo.exe.</p>
<p>Une fois fait, double cliquer sur l&rsquo;adresse initiale à la première ligne et écrire le module puis l&rsquo;offset du joueur, dans notre cas <code>&lt;client.dll>+4DA31EC</code> :</p>
<p><img loading=lazy src=2021-08-15-18-17-39.png#center alt>
</p>
<p>Nous sommes bien dans une liste de joueur. La première ligne corresponds a un pointeur vers la HEAP (la structure d&rsquo;un joueur), puis d&rsquo;autre pointeur vers la HEAP qui correspondent aux autres joueurs.</p>
<p>L&rsquo;écart en mémoire entre chaqu&rsquo;un de ces pointeurs est de <code>0x10</code>, cette information nous servira à itérer sur les joueurs.</p>
<p>Pour trouver le début de cette liste, nous pouvons changer l&rsquo;adresse de départ dans Reclass à <code>&lt;client.dll>+4DA3100</code> puis faire clique droit sur la première ligne et <code>Add 2048 Bytes</code> :</p>
<p><img loading=lazy src=2021-08-15-18-23-06.png#center alt>
</p>
<p>En scrollant vers le bas, on retombe sur la liste de joueur, ce qui nous permet de récupérer l&rsquo;offset du premier joueur de la liste :</p>
<p><img loading=lazy src=2021-08-15-18-27-08.png#center alt>
</p>
<p>L&rsquo;offset est <code>&lt;client.dll>+4DA31BC</code>, pour résumer, nous avons ces informations :</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>Offset de spotted: 0x980
Offset du pointeur correspondant au 1er joueur de la liste: &lt;client.dll&gt;+4DA31BC
Écart entre chaque joueur dans la liste 0x10
</code></pre></td></tr></table>
</div>
</div><h2 id=2ème-étape---création-de-la-dll>2ème étape - Création de la DLL<a hidden class=anchor aria-hidden=true href=#2ème-étape---création-de-la-dll>#</a></h2>
<p>Créer un nouveau projet DLL en C++:</p>
<p><img loading=lazy src=2021-08-15-18-40-37.png#center alt>
<img loading=lazy src=2021-08-15-18-41-13.png#center alt>
</p>
<p>Premièrement, on créé un nouveau Thread lors de l&rsquo;injection de notre DLL :</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp>    <span class=k>case</span> <span class=nl>DLL_PROCESS_ATTACH</span><span class=p>:</span> <span class=p>{</span>
        <span class=n>HANDLE</span> <span class=n>hThread</span> <span class=o>=</span> <span class=k>nullptr</span><span class=p>;</span>
        <span class=n>hThread</span> <span class=o>=</span> <span class=n>CreateThread</span><span class=p>(</span><span class=k>nullptr</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=p>(</span><span class=n>LPTHREAD_START_ROUTINE</span><span class=p>)</span><span class=n>RadarHackThread</span><span class=p>,</span> <span class=n>hModule</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>nullptr</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>hThread</span><span class=p>)</span>
            <span class=n>CloseHandle</span><span class=p>(</span><span class=n>hThread</span><span class=p>);</span>
    <span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>Puis on déclare notre Thread comme ceci:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=n>DWORD</span> <span class=n>WINAPI</span> <span class=nf>RadarHackThread</span><span class=p>(</span><span class=n>HMODULE</span> <span class=n>hModule</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>while</span> <span class=p>(</span><span class=nb>true</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>GetAsyncKeyState</span><span class=p>(</span><span class=n>VK_END</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=k>break</span><span class=p>;</span> <span class=c1>// La touche END désactive le hack proprement
</span><span class=c1></span>    <span class=p>}</span>
    <span class=n>FreeLibraryAndExitThread</span><span class=p>(</span><span class=n>hModule</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
    <span class=n>Sleep</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>On déclare la liste de joueurs grace à l&rsquo;offset précédemment trouvé :</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=hl><span class=lnt> 2
</span></span><span class=hl><span class=lnt> 3
</span></span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=n>DWORD</span> <span class=n>WINAPI</span> <span class=nf>RadarHackThread</span><span class=p>(</span><span class=n>HMODULE</span> <span class=n>hModule</span><span class=p>)</span> <span class=p>{</span>
<span class=hl>    <span class=n>uintptr_t</span> <span class=n>client</span> <span class=o>=</span> <span class=p>(</span><span class=n>uintptr_t</span><span class=p>)</span><span class=n>GetModuleHandle</span><span class=p>(</span><span class=sa>L</span><span class=s>&#34;client.dll&#34;</span><span class=p>);</span>
</span><span class=hl>    <span class=n>uintptr_t</span> <span class=n>playerList</span> <span class=o>=</span> <span class=p>(</span><span class=n>client</span> <span class=o>+</span> <span class=mh>0x4DA31BC</span><span class=p>);</span>
</span>
    <span class=k>while</span> <span class=p>(</span><span class=nb>true</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>GetAsyncKeyState</span><span class=p>(</span><span class=n>VK_END</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=k>break</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>FreeLibraryAndExitThread</span><span class=p>(</span><span class=n>hModule</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
    <span class=n>Sleep</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span></code></pre></td></tr></table>
</div>
</div>
<p>On itère sur les joueurs en incrémentant l&rsquo;adresse de <code>0x10</code> puis on met spotted a TRUE :</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=hl><span class=lnt> 7
</span></span><span class=hl><span class=lnt> 8
</span></span><span class=hl><span class=lnt> 9
</span></span><span class=hl><span class=lnt>10
</span></span><span class=hl><span class=lnt>11
</span></span><span class=hl><span class=lnt>12
</span></span><span class=hl><span class=lnt>13
</span></span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=n>DWORD</span> <span class=n>WINAPI</span> <span class=nf>RadarHackThread</span><span class=p>(</span><span class=n>HMODULE</span> <span class=n>hModule</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>uintptr_t</span> <span class=n>client</span> <span class=o>=</span> <span class=p>(</span><span class=n>uintptr_t</span><span class=p>)</span><span class=n>GetModuleHandle</span><span class=p>(</span><span class=sa>L</span><span class=s>&#34;client.dll&#34;</span><span class=p>);</span>
    <span class=n>uintptr_t</span> <span class=n>playerList</span> <span class=o>=</span> <span class=p>(</span><span class=n>client</span> <span class=o>+</span> <span class=mh>0x4DA31BC</span><span class=p>);</span>

    <span class=k>while</span> <span class=p>(</span><span class=nb>true</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>GetAsyncKeyState</span><span class=p>(</span><span class=n>VK_END</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=k>break</span><span class=p>;</span>
<span class=hl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hl>            <span class=n>uintptr_t</span> <span class=n>player</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>uintptr_t</span><span class=o>*</span> <span class=p>)(</span><span class=n>playerList</span> <span class=o>+</span> <span class=mh>0x10</span> <span class=o>*</span> <span class=n>i</span><span class=p>);</span>
</span><span class=hl>            <span class=k>if</span> <span class=p>(</span><span class=n>player</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hl>                <span class=kt>int</span><span class=o>*</span> <span class=n>spotted</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span><span class=o>*</span><span class=p>)(</span><span class=n>player</span> <span class=o>+</span> <span class=mh>0x980</span><span class=p>);</span>
</span><span class=hl>                <span class=o>*</span><span class=n>spotted</span> <span class=o>=</span> <span class=n>TRUE</span><span class=p>;</span>
</span><span class=hl>            <span class=p>}</span>
</span><span class=hl>        <span class=p>}</span>
</span>    <span class=p>}</span>
    <span class=n>FreeLibraryAndExitThread</span><span class=p>(</span><span class=n>hModule</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
    <span class=n>Sleep</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span></code></pre></td></tr></table>
</div>
</div>
<p>En injectant ce DLL dans csgo.exe, le RadarHack devrait etre fonctionnel :</p>
<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden>
<iframe src=https://player.vimeo.com/video/587598459 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="vimeo video" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</div>
<p>Pour créer votre propre injecteur : <a href=https://violence.digital/articles/injection-dll-loadlibrary/>Injection de DLL - LoadLibrary</a></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://violence.digital/tags/csgo/>csgo</a></li>
<li><a href=https://violence.digital/tags/gamehacking/>gamehacking</a></li>
<li><a href=https://violence.digital/tags/reverse/>reverse</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://violence.digital/articles/injection-dll-loadlibrary/>
<span class=title>« Prev Page</span>
<br>
<span>Injection de DLL - LoadLibrary</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share CS:GO Radar Hack en moins de 40 lignes de code on twitter" href="https://twitter.com/intent/tweet/?text=CS%3aGO%20Radar%20Hack%20en%20moins%20de%2040%20lignes%20de%20code&url=https%3a%2f%2fviolence.digital%2farticles%2fradar-hack-csgo%2f&hashtags=csgo%2cgamehacking%2creverse"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share CS:GO Radar Hack en moins de 40 lignes de code on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fviolence.digital%2farticles%2fradar-hack-csgo%2f&title=CS%3aGO%20Radar%20Hack%20en%20moins%20de%2040%20lignes%20de%20code&summary=CS%3aGO%20Radar%20Hack%20en%20moins%20de%2040%20lignes%20de%20code&source=https%3a%2f%2fviolence.digital%2farticles%2fradar-hack-csgo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share CS:GO Radar Hack en moins de 40 lignes de code on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fviolence.digital%2farticles%2fradar-hack-csgo%2f&title=CS%3aGO%20Radar%20Hack%20en%20moins%20de%2040%20lignes%20de%20code"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share CS:GO Radar Hack en moins de 40 lignes de code on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fviolence.digital%2farticles%2fradar-hack-csgo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share CS:GO Radar Hack en moins de 40 lignes de code on whatsapp" href="https://api.whatsapp.com/send?text=CS%3aGO%20Radar%20Hack%20en%20moins%20de%2040%20lignes%20de%20code%20-%20https%3a%2f%2fviolence.digital%2farticles%2fradar-hack-csgo%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share CS:GO Radar Hack en moins de 40 lignes de code on telegram" href="https://telegram.me/share/url?text=CS%3aGO%20Radar%20Hack%20en%20moins%20de%2040%20lignes%20de%20code&url=https%3a%2f%2fviolence.digital%2farticles%2fradar-hack-csgo%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://violence.digital/>Violence Digital</a></span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
</body>
</html>